{"version":3,"sources":["project/Doctor.js"],"names":["async","projectRoot","await","Binaries","sourceBashLoginScriptsAsync","let","yarnVersionResponse","spawnAsync","status","NO_ISSUES","e","npmVersionResponse","npmVersion","_","trim","stdout","semver","lt","MIN_NPM_VERSION","_isNpmVersionWithinRanges","BAD_NPM_VERSION_RANGES","ProjectUtils","logError","CORRECT_NPM_VERSION","WARNING","WARN_NPM_VERSION_RANGES","logWarning","clearNotification","_checkNpmVersionAsync","Watchman","isPlatformSupported","watchmanVersion","unblockAndGetVersionAsync","MIN_WATCHMAN_VERSION","warningMessage","process","platform","_checkWatchmanVersionAsync","schemaPath","exp","pkg","readConfigJsonAsync","schema","JSON","parse","fs","readFile","promise","validateWithSchema","validateWithSchemaFileAsync","configName","sdkVersion","validateAssets","schemaErrorMessage","assetsErrorMessage","validator","rootDir","validateSchemaAsync","errors","length","map","formatValidationError","join","validateAssetsAsync","Config","helpUrl","validation","reactNativeVersionWarnings","reactNative","dependencies","match","sdkVersions","Api","sdkVersionsAsync","reactNativeTag","sdkVersionObject","major","Versions","parseSdkVersionFromTag","_validatePackageJsonAsync","allowNetwork","FATAL","message","expJsonExists","fileExistsAsync","path","appJsonExists","configFilenameAsync","env","ExpSchema","getSchemaAsync","keys","reactNativeIssue","_validateReactNativeVersionAsync","_validateExpJsonAsync","nodeModulesPath","result","statSync","isDirectory","isFile","npmls","npmlsCommand","cwd","npmlsDependencies","errorStrings","forEach","versionRequired","dependency","installedDependency","version","push","peerMissing","satisfies","includes","from","_validateNodeModulesAsync","validateAsync","validateLowLatencyAsync","validateWithNetworkAsync","strict","getenv","boolish","expStatus","packageStatus","Math","max","ignoreNodeModulesValidation","nodeModulesStatus","sdkPkg","EXPO_SDK_NOT_INSTALLED","mainFilePath","main","mainFile","EXPO_SDK_INSTALLED_AND_IMPORTED","EXPO_SDK_NOT_IMPORTED","getExpoSdkStatus","ranges","some","range","validationError","fieldPath"],"mappings":"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","file":"../../project/Doctor.js","sourcesContent":["/**\n * @flow\n */\n\nimport 'instapromise';\n\nimport _ from 'lodash';\nimport semver from 'semver';\nimport fs from 'fs';\nimport getenv from 'getenv';\nimport path from 'path';\nimport spawnAsync from '@expo/spawn-async';\n\nimport Schemer, { SchemerError } from '@expo/schemer';\n\nimport * as ExpSchema from './ExpSchema';\nimport * as ProjectUtils from './ProjectUtils';\nimport Api from '../Api';\nimport * as Binaries from '../Binaries';\nimport Config from '../Config';\nimport * as Versions from '../Versions';\nimport * as Watchman from '../Watchman';\n\nexport const NO_ISSUES = 0;\nexport const WARNING = 1;\nexport const FATAL = 2;\n\nconst MIN_WATCHMAN_VERSION = '4.6.0';\nconst MIN_NPM_VERSION = '3.0.0';\nconst CORRECT_NPM_VERSION = '4.6.1';\nconst WARN_NPM_VERSION_RANGES = ['>= 5.0.0'];\nconst BAD_NPM_VERSION_RANGES = ['>= 5.0.0 <= 5.0.3'];\n\nfunction _isNpmVersionWithinRanges(npmVersion, ranges) {\n  return _.some(ranges, range => semver.satisfies(npmVersion, range));\n}\n\nasync function _checkNpmVersionAsync(projectRoot) {\n  try {\n    await Binaries.sourceBashLoginScriptsAsync();\n\n    try {\n      let yarnVersionResponse = await spawnAsync('yarnpkg', ['--version']);\n      if (yarnVersionResponse.status === 0) {\n        return NO_ISSUES;\n      }\n    } catch (e) {}\n\n    let npmVersionResponse = await spawnAsync('npm', ['--version']);\n    let npmVersion = _.trim(npmVersionResponse.stdout);\n\n    if (\n      semver.lt(npmVersion, MIN_NPM_VERSION) ||\n      _isNpmVersionWithinRanges(npmVersion, BAD_NPM_VERSION_RANGES)\n    ) {\n      ProjectUtils.logError(\n        projectRoot,\n        'expo',\n        `Error: You are using npm version ${npmVersion}. We recommend version ${CORRECT_NPM_VERSION}. To install it, run 'npm i -g npm@${CORRECT_NPM_VERSION}'.`,\n        'doctor-npm-version'\n      );\n      return WARNING;\n    } else if (_isNpmVersionWithinRanges(npmVersion, WARN_NPM_VERSION_RANGES)) {\n      ProjectUtils.logWarning(\n        projectRoot,\n        'expo',\n        `Warning: You are using npm version ${npmVersion}. There may be bugs in this version, use it at your own risk. We recommend version ${CORRECT_NPM_VERSION}.`,\n        'doctor-npm-version'\n      );\n    } else {\n      ProjectUtils.clearNotification(projectRoot, 'doctor-npm-version');\n    }\n  } catch (e) {\n    ProjectUtils.logWarning(\n      projectRoot,\n      'expo',\n      `Warning: Could not determine npm version. Make sure your version is >= ${MIN_NPM_VERSION} - we recommend ${CORRECT_NPM_VERSION}.`,\n      'doctor-npm-version'\n    );\n    return WARNING;\n  }\n\n  return NO_ISSUES;\n}\n\nasync function _checkWatchmanVersionAsync(projectRoot) {\n  // There's no point in checking any of this stuff if watchman isn't supported on this platform\n  if (!Watchman.isPlatformSupported()) {\n    ProjectUtils.clearNotification(projectRoot, 'doctor-watchman-version');\n    return;\n  }\n\n  let watchmanVersion = await Watchman.unblockAndGetVersionAsync(projectRoot);\n\n  // If we can't get the watchman version, `getVersionAsync` will return `null`\n  if (!watchmanVersion) {\n    // watchman is probably just not installed\n    ProjectUtils.clearNotification(projectRoot, 'doctor-watchman-version');\n    return;\n  }\n\n  if (semver.lt(watchmanVersion, MIN_WATCHMAN_VERSION)) {\n    let warningMessage = `Warning: You are using an old version of watchman (v${watchmanVersion}). This may cause problems for you.\\n\\nWe recommend that you either uninstall watchman (and XDE will try to use a copy it is bundled with) or upgrade watchman to a newer version, at least v${MIN_WATCHMAN_VERSION}.`;\n\n    // Add a note about homebrew if the user is on a Mac\n    if (process.platform === 'darwin') {\n      warningMessage += `\\n\\nIf you are using homebrew, try:\\nbrew uninstall watchman; brew install watchman`;\n    }\n    ProjectUtils.logWarning(projectRoot, 'expo', warningMessage, 'doctor-watchman-version');\n  } else {\n    ProjectUtils.clearNotification(projectRoot, 'doctor-watchman-version');\n  }\n}\n\nexport async function validateWithSchemaFileAsync(\n  projectRoot: string,\n  schemaPath: string\n): Promise<{ errorMessage?: string }> {\n  let { exp, pkg } = await ProjectUtils.readConfigJsonAsync(projectRoot);\n  let schema = JSON.parse(await fs.readFile.promise(schemaPath, 'utf8'));\n  return validateWithSchema(projectRoot, exp, schema.schema, 'exp.json', 'UNVERSIONED', true);\n}\n\nexport async function validateWithSchema(\n  projectRoot: string,\n  exp: any,\n  schema: any,\n  configName: string,\n  sdkVersion: string,\n  validateAssets: boolean\n): { errorMessage?: string } {\n  let schemaErrorMessage;\n  let assetsErrorMessage;\n  let validator = new Schemer(schema, { rootDir: projectRoot });\n\n  // Validate the schema itself\n  try {\n    await validator.validateSchemaAsync(exp);\n  } catch (e) {\n    if (e instanceof SchemerError) {\n      schemaErrorMessage = `Warning: Problem${e.errors.length > 1\n        ? 's'\n        : ''} validating fields in ${configName}. See https://docs.expo.io/versions/v${sdkVersion}/guides/configuration.html.`;\n      schemaErrorMessage += e.errors.map(formatValidationError).join('');\n    }\n  }\n\n  if (validateAssets) {\n    try {\n      await validator.validateAssetsAsync(exp);\n    } catch (e) {\n      if (e instanceof SchemerError) {\n        assetsErrorMessage = `Warning: Problem${e.errors.length > 1\n          ? ''\n          : 's'} validating asset fields in ${configName}. See ${Config.helpUrl}`;\n        assetsErrorMessage += e.errors.map(formatValidationError).join('');\n      }\n    }\n  }\n  return { schemaErrorMessage, assetsErrorMessage };\n}\n\nfunction formatValidationError(validationError) {\n  return `\\n â€¢ ${validationError.fieldPath\n    ? 'Field: ' + validationError.fieldPath + ' - '\n    : ''}${validationError.message}.`;\n}\n\nasync function _validatePackageJsonAsync(exp, pkg, projectRoot): Promise<number> {\n  // TODO: Check any native module versions here\n  if (Config.validation.reactNativeVersionWarnings) {\n    let reactNative = pkg.dependencies['react-native'];\n\n    // Expo fork of react-native is required\n    // TODO(2016-12-20): Remove the check for our old \"exponentjs\" org eventually\n    if (!reactNative.match(/(exponent(?:js)?|expo)\\/react-native/)) {\n      ProjectUtils.logWarning(\n        projectRoot,\n        'expo',\n        `Warning: Not using the Expo fork of react-native. See ${Config.helpUrl}.`,\n        'doctor-not-using-expo-fork'\n      );\n      return WARNING;\n    }\n    ProjectUtils.clearNotification(projectRoot, 'doctor-not-using-expo-fork');\n\n    let sdkVersions = await Api.sdkVersionsAsync();\n    let sdkVersion = exp.sdkVersion;\n    try {\n      let reactNativeTag = reactNative.match(/sdk-\\d+\\.\\d+\\.\\d+/)[0];\n      let sdkVersionObject = sdkVersions[sdkVersion];\n\n      // TODO: Want to be smarter about this. Maybe warn if there's a newer version.\n      if (\n        semver.major(Versions.parseSdkVersionFromTag(reactNativeTag)) !==\n        semver.major(Versions.parseSdkVersionFromTag(sdkVersionObject['expoReactNativeTag']))\n      ) {\n        ProjectUtils.logWarning(\n          projectRoot,\n          'expo',\n          `Warning: Invalid version of react-native for sdkVersion ${sdkVersion}. Use github:expo/react-native#${sdkVersionObject[\n            'expoReactNativeTag'\n          ]}`,\n          'doctor-invalid-version-of-react-native'\n        );\n        return WARNING;\n      }\n      ProjectUtils.clearNotification(projectRoot, 'doctor-invalid-version-of-react-native');\n\n      ProjectUtils.clearNotification(projectRoot, 'doctor-malformed-version-of-react-native');\n    } catch (e) {\n      ProjectUtils.logWarning(\n        projectRoot,\n        'expo',\n        `Warning: ${reactNative} is not a valid version. Version must be in the form of sdk-x.y.z. Please update your package.json file.`,\n        'doctor-malformed-version-of-react-native'\n      );\n      return WARNING;\n    }\n  }\n  return NO_ISSUES;\n}\n\nasync function _validateExpJsonAsync(exp, pkg, projectRoot, allowNetwork): Promise<number> {\n  if (!exp || !pkg) {\n    // readConfigJsonAsync already logged an error\n    return FATAL;\n  }\n\n  try {\n    await _checkWatchmanVersionAsync(projectRoot);\n  } catch (e) {\n    ProjectUtils.logWarning(\n      projectRoot,\n      'expo',\n      `Warning: Problem checking watchman version. ${e.message}.`,\n      'doctor-problem-checking-watchman-version'\n    );\n  }\n  ProjectUtils.clearNotification(projectRoot, 'doctor-problem-checking-watchman-version');\n\n  const expJsonExists = await ProjectUtils.fileExistsAsync(path.join(projectRoot, 'exp.json'));\n  const appJsonExists = await ProjectUtils.fileExistsAsync(path.join(projectRoot, 'app.json'));\n\n  if (expJsonExists && appJsonExists) {\n    ProjectUtils.logWarning(\n      projectRoot,\n      'expo',\n      `Warning: Both app.json and exp.json exist in this directory. Only one should exist for a single project.`,\n      'doctor-both-app-and-exp-json'\n    );\n    return WARNING;\n  }\n  ProjectUtils.clearNotification(projectRoot, 'doctor-both-app-and-exp-json');\n\n  let sdkVersion = exp.sdkVersion;\n  const configName = await ProjectUtils.configFilenameAsync(projectRoot);\n\n  // Skip validation if the correct token is set in env\n  if (!(sdkVersion === 'UNVERSIONED' && process.env['EXPO_SKIP_MANIFEST_VALIDATION_TOKEN'])) {\n    try {\n      let schema = await ExpSchema.getSchemaAsync(sdkVersion);\n      let { schemaErrorMessage, assetsErrorMessage } = await validateWithSchema(\n        projectRoot,\n        exp,\n        schema,\n        configName,\n        sdkVersion,\n        allowNetwork\n      );\n\n      if (schemaErrorMessage) {\n        ProjectUtils.logWarning(\n          projectRoot,\n          'expo',\n          schemaErrorMessage,\n          'doctor-schema-validation'\n        );\n      } else {\n        ProjectUtils.clearNotification(projectRoot, 'doctor-schema-validation');\n      }\n      if (assetsErrorMessage) {\n        ProjectUtils.logWarning(\n          projectRoot,\n          'expo',\n          assetsErrorMessage,\n          `doctor-validate-asset-fields`\n        );\n      } else {\n        ProjectUtils.clearNotification(projectRoot, `doctor-validate-asset-fields`);\n      }\n      ProjectUtils.clearNotification(projectRoot, 'doctor-schema-validation-exception');\n      if (schemaErrorMessage || assetsErrorMessage) return WARNING;\n    } catch (e) {\n      ProjectUtils.logWarning(\n        projectRoot,\n        'expo',\n        `Warning: Problem validating ${configName}: ${e.message}.`,\n        'doctor-schema-validation-exception'\n      );\n    }\n  }\n\n  // Warn if sdkVersion is UNVERSIONED\n  if (sdkVersion === 'UNVERSIONED') {\n    ProjectUtils.logWarning(\n      projectRoot,\n      'expo',\n      `Warning: Using unversioned Expo SDK. Do not publish until you set sdkVersion in ${configName}`,\n      'doctor-unversioned'\n    );\n    return WARNING;\n  }\n  ProjectUtils.clearNotification(projectRoot, 'doctor-unversioned');\n\n  // react-native is required\n  if (!pkg.dependencies || !pkg.dependencies['react-native']) {\n    ProjectUtils.logWarning(\n      projectRoot,\n      'expo',\n      `Warning: Can't find react-native in package.json dependencies`,\n      'doctor-no-react-native-in-package-json'\n    );\n    return WARNING;\n  }\n  ProjectUtils.clearNotification(projectRoot, 'doctor-no-react-native-in-package-json');\n\n  // TODO(adam) set up caching for this\n  let sdkVersions = await Api.sdkVersionsAsync();\n  if (!sdkVersions) {\n    ProjectUtils.logWarning(\n      projectRoot,\n      'expo',\n      `Warning: Couldn't connect to SDK versions server`,\n      'doctor-versions-endpoint-failed'\n    );\n    return WARNING;\n  }\n  ProjectUtils.clearNotification(projectRoot, 'doctor-versions-endpoint-failed');\n\n  if (!sdkVersions[sdkVersion]) {\n    ProjectUtils.logWarning(\n      projectRoot,\n      'expo',\n      `Warning: Invalid sdkVersion. Valid options are ${_.keys(sdkVersions).join(', ')}`,\n      'doctor-invalid-sdk-version'\n    );\n    return WARNING;\n  }\n  ProjectUtils.clearNotification(projectRoot, 'doctor-invalid-sdk-version');\n\n  const reactNativeIssue = await _validateReactNativeVersionAsync(\n    exp,\n    pkg,\n    projectRoot,\n    sdkVersions,\n    sdkVersion\n  );\n\n  if (reactNativeIssue !== NO_ISSUES) {\n    return reactNativeIssue;\n  }\n\n  // TODO: Check any native module versions here\n\n  return NO_ISSUES;\n}\n\nasync function _validateReactNativeVersionAsync(\n  exp,\n  pkg,\n  projectRoot,\n  sdkVersions,\n  sdkVersion\n): Promise<number> {\n  if (Config.validation.reactNativeVersionWarnings) {\n    let reactNative = pkg.dependencies['react-native'];\n\n    // TODO(2016-12-20): Remove the check for our old \"exponentjs\" org eventually\n    if (!reactNative.match(/(exponent(?:js)?|expo)\\/react-native/)) {\n      return NO_ISSUES;\n\n      // (TODO-2017-07-20): Validate the react-native version if it uses\n      // officially published package rather than Expo fork. Expo fork of\n      // react-native was required before CRNA. We now only run the react-native\n      // validation of the version if we are using the fork. We should probably\n      // validate the version here as well such that it matches with the\n      // react-native version compatible with the selected SDK.\n      //\n      // ProjectUtils.logWarning(\n      //   projectRoot,\n      //   'expo',\n      //   `Warning: Not using the Expo fork of react-native. See ${Config.helpUrl}.`,\n      //   'doctor-not-using-expo-fork'\n      // );\n      // return WARNING;\n    }\n    ProjectUtils.clearNotification(projectRoot, 'doctor-not-using-expo-fork');\n\n    try {\n      let reactNativeTag = reactNative.match(/sdk-\\d+\\.\\d+\\.\\d+/)[0];\n      let sdkVersionObject = sdkVersions[sdkVersion];\n\n      // TODO: Want to be smarter about this. Maybe warn if there's a newer version.\n      if (\n        semver.major(Versions.parseSdkVersionFromTag(reactNativeTag)) !==\n        semver.major(Versions.parseSdkVersionFromTag(sdkVersionObject['expoReactNativeTag']))\n      ) {\n        ProjectUtils.logWarning(\n          projectRoot,\n          'expo',\n          `Warning: Invalid version of react-native for sdkVersion ${sdkVersion}. Use github:expo/react-native#${sdkVersionObject[\n            'expoReactNativeTag'\n          ]}`,\n          'doctor-invalid-version-of-react-native'\n        );\n        return WARNING;\n      }\n      ProjectUtils.clearNotification(projectRoot, 'doctor-invalid-version-of-react-native');\n\n      ProjectUtils.clearNotification(projectRoot, 'doctor-malformed-version-of-react-native');\n    } catch (e) {\n      ProjectUtils.logWarning(\n        projectRoot,\n        'expo',\n        `Warning: ${reactNative} is not a valid version. Version must be in the form of sdk-x.y.z. Please update your package.json file.`,\n        'doctor-malformed-version-of-react-native'\n      );\n      return WARNING;\n    }\n  }\n\n  return NO_ISSUES;\n}\n\n// TODO: use `yarn check`\nasync function _validateNodeModulesAsync(projectRoot): Promise<number> {\n  let { exp, pkg } = await ProjectUtils.readConfigJsonAsync(projectRoot);\n  let nodeModulesPath = projectRoot;\n  if (exp.nodeModulesPath) {\n    nodeModulesPath = path.join(projectRoot, exp.nodeModulesPath);\n  }\n\n  // Check to make sure node_modules exists at all\n  try {\n    let result = fs.statSync(path.join(nodeModulesPath, 'node_modules'));\n    if (!result.isDirectory()) {\n      ProjectUtils.logError(\n        projectRoot,\n        'expo',\n        `Error: node_modules directory is missing. Please run \\`npm install\\` in your project directory.`,\n        'doctor-node-modules-missing'\n      );\n      return FATAL;\n    }\n\n    ProjectUtils.clearNotification(projectRoot, 'doctor-node-modules-missing');\n  } catch (e) {\n    ProjectUtils.logError(\n      projectRoot,\n      'expo',\n      `Error: node_modules directory is missing. Please run \\`npm install\\` in your project directory.`,\n      'doctor-node-modules-missing'\n    );\n    return FATAL;\n  }\n\n  // Check to make sure react native is installed\n  try {\n    let result = fs.statSync(\n      path.join(nodeModulesPath, 'node_modules', 'react-native', 'local-cli', 'cli.js')\n    );\n    if (!result.isFile()) {\n      ProjectUtils.logError(\n        projectRoot,\n        'expo',\n        `Error: React native is not installed. Please run \\`npm install\\` in your project directory.`,\n        'doctor-react-native-not-installed'\n      );\n      return FATAL;\n    }\n\n    ProjectUtils.clearNotification(projectRoot, 'doctor-react-native-not-installed');\n  } catch (e) {\n    ProjectUtils.logError(\n      projectRoot,\n      'expo',\n      `Error: React native is not installed. Please run \\`npm install\\` in your project directory.`,\n      'doctor-react-native-not-installed'\n    );\n    return FATAL;\n  }\n\n  // Validate all package.json dependencies are installed and up to date\n  if (pkg.dependencies) {\n    await Binaries.sourceBashLoginScriptsAsync();\n\n    try {\n      await spawnAsync('npm', ['--version']);\n    } catch (e) {\n      ProjectUtils.logWarning(\n        projectRoot,\n        'expo',\n        `\\`npm\\` command not found. If you have npm installed please run \\`npm install -g exp && exp path\\`.`,\n        'doctor-npm-not-found'\n      );\n      return WARNING;\n    }\n    ProjectUtils.clearNotification(projectRoot, 'doctor-npm-not-found');\n\n    let npmls;\n    try {\n      let npmlsCommand = await spawnAsync('npm', ['ls', '--json', '--depth', '1'], {\n        cwd: nodeModulesPath,\n      });\n      npmls = npmlsCommand.stdout;\n    } catch (e) {\n      npmls = e.stdout; // `npm ls` sometimes returns an error code\n    }\n\n    if (!npmls) {\n      ProjectUtils.logWarning(\n        projectRoot,\n        'expo',\n        `Problem checking node_modules dependencies. Could not run \\`npm ls\\` in ${projectRoot}.`,\n        'doctor-could-not-run-npm-ls'\n      );\n      return WARNING;\n    }\n    ProjectUtils.clearNotification(projectRoot, 'doctor-could-not-run-npm-ls');\n\n    let npmlsDependencies;\n    try {\n      npmlsDependencies = JSON.parse(npmls).dependencies;\n    } catch (e) {\n      ProjectUtils.logWarning(\n        projectRoot,\n        'expo',\n        `Problem checking node_modules dependencies: ${e.message}`,\n        'doctor-problem-checking-node-modules'\n      );\n      return WARNING;\n    }\n    ProjectUtils.clearNotification(projectRoot, 'doctor-problem-checking-node-modules');\n\n    if (npmlsDependencies) {\n      let errorStrings = [];\n      _.forEach(pkg.dependencies, (versionRequired, dependency) => {\n        let installedDependency = npmlsDependencies[dependency];\n        if (dependency === 'react' && versionRequired.match(/-(alpha|beta|rc)/)) {\n          // ignore prerelease dependencies on react\n        } else if (\n          dependency === 'expo' &&\n          exp.sdkVersion !== 'UNVERSIONED' &&\n          semver.major(installedDependency.version) !== semver.major(exp.sdkVersion)\n        ) {\n          // Warn user if versions are not aligned\n          errorStrings.push(\n            'Warning: Expo version in package.json does not match sdkVersion in manifest.'\n          );\n        } else if (!installedDependency || !installedDependency.version) {\n          if (installedDependency && installedDependency.peerMissing) {\n            errorStrings.push(\n              `Warning: '${dependency}' peer depencency missing. Run \\`npm ls\\` in ${nodeModulesPath} to see full warning.`\n            );\n          } else {\n            errorStrings.push(`Warning: '${dependency}' dependency is not installed.`);\n          }\n        } else if (\n          dependency !== 'react-native' &&\n          !semver.satisfies(installedDependency.version, versionRequired) &&\n          !versionRequired.includes(installedDependency.from)\n        ) {\n          // TODO: also check react-native\n          // For react native, `from` field looks like \"expo/react-native#sdk-8.0.1\" and\n          // versionRequired looks like \"github:expo/react-native#sdk-8.0.0\"\n          errorStrings.push(\n            `Warning: Installed version ${installedDependency.version} of '${dependency}' does not satisfy required version ${versionRequired}`\n          );\n        }\n      });\n\n      if (errorStrings.length > 0) {\n        errorStrings.push(\n          `\\nIf there is an issue running your project, please run \\`npm install\\` in ${nodeModulesPath} and restart.`\n        );\n        ProjectUtils.logWarning(\n          projectRoot,\n          'expo',\n          errorStrings.join('\\n'),\n          'doctor-node-modules-issues'\n        );\n        return WARNING;\n      } else {\n        ProjectUtils.clearNotification(projectRoot, 'doctor-node-modules-issues');\n      }\n    }\n  }\n\n  return NO_ISSUES;\n}\n\nexport async function validateLowLatencyAsync(projectRoot: string): Promise<number> {\n  return validateAsync(projectRoot, false);\n}\n\nexport async function validateWithNetworkAsync(projectRoot: string): Promise<number> {\n  return validateAsync(projectRoot, true);\n}\n\nasync function validateAsync(\n  projectRoot: string,\n  allowNetwork: boolean,\n  strict: boolean\n): Promise<number> {\n  if (getenv.boolish('EXPO_NO_DOCTOR', false)) {\n    return NO_ISSUES;\n  }\n\n  let { exp, pkg } = await ProjectUtils.readConfigJsonAsync(projectRoot);\n\n  let status = await _checkNpmVersionAsync(projectRoot);\n  if (status === FATAL) {\n    return status;\n  }\n\n  const expStatus = await _validateExpJsonAsync(exp, pkg, projectRoot, allowNetwork);\n  if (expStatus === FATAL) {\n    return expStatus;\n  }\n\n  const packageStatus = await _validatePackageJsonAsync(exp, pkg, projectRoot);\n\n  status = Math.max(status, expStatus, packageStatus);\n  if (status === FATAL) return status;\n\n  // TODO: this broke once we started using yarn because `npm ls` doesn't\n  // work on a yarn install. Use `yarn check` in the future.\n  if (status !== FATAL && exp && !exp.ignoreNodeModulesValidation) {\n    let nodeModulesStatus = await _validateNodeModulesAsync(projectRoot);\n    if (nodeModulesStatus > status) {\n      return nodeModulesStatus;\n    }\n  }\n\n  return status;\n}\n\nexport const EXPO_SDK_INSTALLED_AND_IMPORTED = 0;\nexport const EXPO_SDK_NOT_INSTALLED = 1;\nexport const EXPO_SDK_NOT_IMPORTED = 2;\n\nexport async function getExpoSdkStatus(projectRoot: string): Promise<number> {\n  let { pkg } = await ProjectUtils.readConfigJsonAsync(projectRoot);\n\n  try {\n    let sdkPkg;\n    if (pkg.dependencies['exponent']) {\n      sdkPkg = 'exponent';\n    } else if (pkg.dependencies['expo']) {\n      sdkPkg = 'expo';\n    } else {\n      return EXPO_SDK_NOT_INSTALLED;\n    }\n\n    let mainFilePath = path.join(projectRoot, pkg.main);\n    let mainFile = await fs.readFile.promise(mainFilePath, 'utf8');\n\n    // TODO: support separate .ios.js and .android.js files\n    if (mainFile.includes(`from '${sdkPkg}'`) || mainFile.includes(`require('${sdkPkg}')`)) {\n      return EXPO_SDK_INSTALLED_AND_IMPORTED;\n    } else {\n      return EXPO_SDK_NOT_IMPORTED;\n    }\n  } catch (e) {\n    return EXPO_SDK_NOT_IMPORTED;\n  }\n}\n"],"sourceRoot":"/xdl/src"}